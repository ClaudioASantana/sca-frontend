<mat-card>
  <mat-card-title>Usuários</mat-card-title>
  <mat-card-content>
    <ng-template #confirmDialog>
      <h2 mat-dialog-title>Confirmar</h2>
      <mat-dialog-content>Confirmar criação do usuário?</mat-dialog-content>
      <mat-dialog-actions align="end">
        <button mat-button mat-dialog-close="false">Cancelar</button>
        <button mat-raised-button color="primary" mat-dialog-close="true">Confirmar</button>
      </mat-dialog-actions>
    </ng-template>

    <form [formGroup]="form" (ngSubmit)="create()" style="display: grid; grid-template-columns: 1fr 1fr 120px; gap: 12px; margin-bottom: 16px;">
      <mat-form-field appearance="outline">
        <mat-label>Nome</mat-label>
        <input matInput formControlName="name" placeholder="Nome" />
        <mat-hint align="start">Mínimo de 2 caracteres</mat-hint>
        <mat-error *ngIf="form.controls['name'].touched && form.controls['name'].hasError('required')">Nome é obrigatório</mat-error>
        <mat-error *ngIf="form.controls['name'].touched && form.controls['name'].hasError('minlength')">Mínimo de 2 caracteres</mat-error>
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>E-mail</mat-label>
        <input matInput type="email" formControlName="email" placeholder="E-mail" />
        <mat-hint align="start">Informe um e-mail válido</mat-hint>
        <mat-error *ngIf="form.controls['email'].touched && form.controls['email'].hasError('required')">E-mail é obrigatório</mat-error>
        <mat-error *ngIf="form.controls['email'].touched && form.controls['email'].hasError('email')">E-mail inválido</mat-error>
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Idade</mat-label>
        <input matInput type="number" formControlName="age" />
        <mat-hint align="start">Faixa permitida: 18 a 120</mat-hint>
        <mat-error *ngIf="form.controls['age'].touched && form.controls['age'].hasError('required')">Idade é obrigatória</mat-error>
        <mat-error *ngIf="form.controls['age'].touched && form.controls['age'].hasError('min')">Mínimo 18 anos</mat-error>
        <mat-error *ngIf="form.controls['age'].touched && form.controls['age'].hasError('max')">Máximo 120 anos</mat-error>
      </mat-form-field>
      <button mat-raised-button color="primary" type="submit" [disabled]="form.invalid || loading">{{ loading ? 'Adicionando...' : 'Adicionar' }}</button>
    </form>
    <mat-form-field appearance="outline" style="width: 100%; margin-bottom: 12px;">
      <mat-label>Filtrar</mat-label>
      <input matInput (keyup)="applyFilter($event)" placeholder="Digite para filtrar" />
    </mat-form-field>

    <table mat-table [dataSource]="dataSource" matSort>
      <ng-container matColumnDef="id">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>ID</th>
        <td mat-cell *matCellDef="let row">{{ row.id }}</td>
      </ng-container>

      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Nome</th>
        <td mat-cell *matCellDef="let row">{{ row.name }}</td>
      </ng-container>

      <ng-container matColumnDef="email">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>E-mail</th>
        <td mat-cell *matCellDef="let row">{{ row.email }}</td>
      </ng-container>

      <ng-container matColumnDef="role">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Papel</th>
        <td mat-cell *matCellDef="let row">{{ row.role }}</td>
      </ng-container>

      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Status</th>
        <td mat-cell *matCellDef="let row">{{ row.status }}</td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>

    <mat-paginator [pageSizeOptions]="[5, 10, 25]" showFirstLastButtons></mat-paginator>
  </mat-card-content>
</mat-card>
